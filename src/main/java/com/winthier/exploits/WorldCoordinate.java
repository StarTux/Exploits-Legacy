package com.winthier.exploits;

import lombok.AllArgsConstructor;
import lombok.NonNull;
import lombok.Value;

@Value
@AllArgsConstructor(staticName="of")
public class WorldCoordinate {
    @NonNull
    private final String world;
    private final int x;
    private final int y;
    private final int z;

    public WorldCoordinate toChunkCoordinate() {
        int x = this.x / 16;
        int y = this.y / 16;
        int z = this.z / 16;
        if (this.x < 0) x -= 1;
        if (this.y < 0) y -= 1;
        if (this.z < 0) z -= 1;
        return WorldCoordinate.of(world, x, y, z);
    }

    public WorldCoordinate relative(int dx, int dy, int dz) {
        return WorldCoordinate.of(world, x+dx, y+dy, z+dz);
    }

    public Coordinate toCoordinateInChunk() {
        int x = this.x % 16;
        int y = this.y % 16;
        int z = this.z % 16;
        if (x < 0) x += 16;
        if (y < 0) y += 16;
        if (z < 0) z += 16;
        return Coordinate.of(x, y, z);
    }

    public int distanceSquared(@NonNull WorldCoordinate other) {
        if (!other.world.equals(this.world)) return Integer.MAX_VALUE;
        int dx = other.getX() - this.x;
        int dy = other.getY() - this.y;
        int dz = other.getZ() - this.z;
        return dx*dx + dy*dy + dz*dz;
    }

    public double distance(@NonNull WorldCoordinate other) {
        return Math.sqrt(distanceSquared(other));
    }
}
